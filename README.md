# Бэкенд-часть платформы по перепродаже вещей

https://github.com/ViacheslavPrivalov/avito/assets/123068340/924026e3-52ad-43c2-a1f1-eb08f216681b

## Описание

Для проекта платформы по перепродаже вещей была написана BackEnd часть на Node JS, с использованием фреймворка [Nest](https://nestjs.com/).

По заданной OpenAPI спецификации был реализован следующий функционал:

- Авторизация и аутентификация пользователей.
- Распределение ролей между пользователями: пользователь и администратор.
- CRUD-операции для объявлений и комментариев: администратор может удалять или
  редактировать все объявления и комментарии, а пользователи — только свои.
- Возможность для пользователей оставлять комментарии под каждым объявлением.
  Показ и сохранение картинок объявлений, а также аватарок пользователей.

## Установка

### Установка и запуск фронтенда

Для проекта платформы по перепродаже вещей создана [фронтенд-часть](https://github.com/dmitry-bizin/front-react-avito) сайта. Чтобы её использовать вам нужно установить [Docker Desktop](https://www.docker.com/products/docker-desktop/).

1. **Установка Docker**: Для установки [Docker](https://www.docker.com/) на ваш компьютер нужно установить Docker Desktop.

2. **Запуск фронтенда с помощью Docker**: Чтобы запустить фронтенд с помощью установленного Docker, нужно открыть командную строку (или терминал) и выполнить следующую команду:

   ```bash
   docker run -p 3000:3000 --rm ghcr.io/dmitry-bizin/front-react-avito:v1.21
   ```

После выполнения команды frontend запустится на порту 3000 и можно будет зайти на него через браузер по адресу: `http://localhost:3000`

### Установка бэкенда

1. **Клонирование репозитория**: Сначала клонируйте репозиторий на свой локальный компьютер с помощью команды `git clone`. Замените `URL` на URL вашего репозитория:

   ```bash
   git clone URL
   ```

2. **Установка зависимостей**: Перейдите в каталог проекта и установите необходимые зависимости с помощью команды `npm install`:

   ```bash
   cd имя-вашего-проекта
   npm install
   ```

3. **Запуск проекта**: Запустите проект с помощью команды `npm run start`:

   ```bash
   npm run start
   ```

**Запуск бэкенда с помощью Docker**: Чтобы запустить бэкенд с помощью установленного Docker, нужно открыть командную строку (или терминал) и выполнить следующую команду:

```bash
docker-compose up
```

После выполнения этих шагов ваше приложение должно быть успешно установлено и запущено.

Документация API доступна по адресу: `http://localhost:8080/api`

## Стек технологий

В этом проекте используются следующие технологии:

- NestJS
- PostgreSQL
- TypeORM
- CASL
- Class-transformer
- Class-validator
- Swagger
- Jest
- Supertest
- Automock

## Лицензия

Данный проект создан в учебных целях. Допускается использование данного кода в полном или частичном объеме в других проектах.

## Функциональность

**Приложение обеспечивает:**

- Создание необходимых сущностей: пользователь, объявление, комментарий в базе данных _PostrgeSQL_ посредством _TypeORM_;
- Авторизацию и аутентификацию пользователей с помощью _AuthGuard_ с Basic аутентификацией в формате:

```bash
Authorization: Basic base64Encode(user:password)
```

- Управление объявлениями и комментариями, контроль доступа на основе ролей (пользователь, администратор) с помощью библиотеки _CASL_;
- Валидацию данных с помощью собственной реализации _ValidationPipe_ в связке с _class-validator_ и _class-transformer_;
- Обработку возникающих ошибок и исключений с помощью _AllExceptionsFilter_;
- Логирование запросов и ответов, а также всех исключений при помощи _LoggerMiddleware_;

**Допольнительно**

- Хранение и извлечение изображений объявлений и аватарок пользователей в базе данных и локально в файловой системе;
- Реализованы unit-тесты для контроллеров и сервисов;
- E2E-тесты покрывают основные модули приложения.
